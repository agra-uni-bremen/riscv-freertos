Based on SW available from github:

https://gist.github.com/austinmarton/2862515
https://gist.github.com/austinmarton/1922600
